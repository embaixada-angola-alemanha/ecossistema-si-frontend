<!-- Featured Event Hero -->
@if (featuredEvent(); as event) {
  <section class="event-hero">
    <div class="event-hero__overlay"></div>
    <a [routerLink]="['/eventos', event.id]" class="event-hero__link">
      <div class="container event-hero__content">
        @if (isHappeningNow()) {
          <span class="event-hero__badge event-hero__badge--live">
            <span class="event-hero__pulse"></span>
            {{ 'events.featured_now' | translate }}
          </span>
        } @else {
          <span class="event-hero__badge">
            {{ 'events.featured_soon' | translate }}
          </span>
        }

        <h1 class="event-hero__title">{{ event | localizedEvent:'titulo' }}</h1>

        <div class="event-hero__meta">
          <span class="event-hero__meta-item">
            <span class="material-icons-outlined">calendar_today</span>
            {{ event.dataInicio | date:'dd MMM yyyy' }}
            @if (event.dataFim) {
              <span> â€” {{ event.dataFim | date:'dd MMM yyyy' }}</span>
            }
          </span>
          @if (event | localizedEvent:'local'; as location) {
            <span class="event-hero__meta-item">
              <span class="material-icons-outlined">place</span>
              {{ location }}
            </span>
          }
        </div>

        @if (!isHappeningNow() && daysUntilFeatured() > 0) {
          <div class="event-hero__countdown">
            <span class="event-hero__countdown-number">{{ daysUntilFeatured() }}</span>
            {{ daysUntilFeatured() === 1
              ? ('events.day_remaining' | translate)
              : ('events.days_remaining' | translate) }}
          </div>
        }
      </div>
    </a>
  </section>
}

<!-- Tab Navigation -->
<section class="section">
  <div class="container">
    <nav class="events-tabs">
      <button class="events-tabs__btn"
              [class.events-tabs__btn--active]="activeTab() === 'upcoming'"
              (click)="setTab('upcoming')">
        <span class="material-icons-outlined">event</span>
        {{ 'events.tab_upcoming' | translate }}
      </button>
      <button class="events-tabs__btn"
              [class.events-tabs__btn--active]="activeTab() === 'calendar'"
              (click)="setTab('calendar')">
        <span class="material-icons-outlined">calendar_month</span>
        {{ 'events.tab_calendar' | translate }}
      </button>
      <button class="events-tabs__btn"
              [class.events-tabs__btn--active]="activeTab() === 'past'"
              (click)="setTab('past')">
        <span class="material-icons-outlined">history</span>
        {{ 'events.tab_past' | translate }}
      </button>
    </nav>

    <!-- Upcoming Tab -->
    @if (activeTab() === 'upcoming') {
      @if (loading()) {
        <p class="events-empty">{{ 'common.loading' | translate }}</p>
      } @else if (upcomingEvents().length > 0) {
        <div class="events-grid">
          @for (event of upcomingEvents(); track event.id) {
            <a [routerLink]="['/eventos', event.id]" class="event-card">
              <div class="event-card__date-block">
                <span class="event-card__day">{{ event.dataInicio | date:'dd' }}</span>
                <span class="event-card__month">{{ event.dataInicio | date:'MMM' }}</span>
                <span class="event-card__year">{{ event.dataInicio | date:'yyyy' }}</span>
              </div>
              <div class="event-card__body">
                <div class="event-card__type-badge">{{ event.tipoEvento }}</div>
                <h3 class="event-card__title">{{ event | localizedEvent:'titulo' }}</h3>
                <p class="event-card__excerpt">{{ event | localizedEvent:'descricao' | stripHtml }}</p>
                <div class="event-card__meta">
                  @if (event | localizedEvent:'local'; as location) {
                    <span class="event-card__location">
                      <span class="material-icons-outlined">place</span>
                      {{ location }}
                    </span>
                  }
                </div>
              </div>
              <span class="event-card__arrow material-icons-outlined">arrow_forward</span>
            </a>
          }
        </div>
      } @else if (!featuredEvent()) {
        <p class="events-empty">{{ 'events.no_upcoming' | translate }}</p>
      } @else {
        <p class="events-empty events-empty--subtle">{{ 'events.no_upcoming' | translate }}</p>
      }
    }

    <!-- Calendar Tab -->
    @if (activeTab() === 'calendar') {
      <si-event-calendar />
    }

    <!-- Past/Archive Tab -->
    @if (activeTab() === 'past') {
      @if (pastLoading() && pastEvents().length === 0) {
        <p class="events-empty">{{ 'common.loading' | translate }}</p>
      } @else if (pastEvents().length > 0) {
        <div class="events-grid">
          @for (event of pastEvents(); track event.id) {
            <a [routerLink]="['/eventos', event.id]" class="event-card event-card--past">
              <div class="event-card__date-block">
                <span class="event-card__day">{{ event.dataInicio | date:'dd' }}</span>
                <span class="event-card__month">{{ event.dataInicio | date:'MMM' }}</span>
                <span class="event-card__year">{{ event.dataInicio | date:'yyyy' }}</span>
              </div>
              <div class="event-card__body">
                <div class="event-card__type-badge">{{ event.tipoEvento }}</div>
                <h3 class="event-card__title">{{ event | localizedEvent:'titulo' }}</h3>
                <p class="event-card__excerpt">{{ event | localizedEvent:'descricao' | stripHtml }}</p>
                <div class="event-card__meta">
                  @if (event | localizedEvent:'local'; as location) {
                    <span class="event-card__location">
                      <span class="material-icons-outlined">place</span>
                      {{ location }}
                    </span>
                  }
                </div>
              </div>
            </a>
          }
        </div>

        @if (pastHasMore() && !pastLoading()) {
          <div class="load-more">
            <button class="btn btn--outline" (click)="loadMorePast()">
              {{ 'events.load_more' | translate }}
            </button>
          </div>
        }
      } @else {
        <p class="events-empty">{{ 'events.no_past' | translate }}</p>
      }
    }
  </div>
</section>
